- name: Run Terraform for {{ playbook_dir }}/autogenerated/{{ inventory_hostname }}/{{ compose_name }} with portainer_stack.{{ compose_name }}
  cloud.terraform.terraform:
    project_path: "{{ playbook_dir }}/autogenerated/{{ inventory_hostname }}/{{ compose_name }}"
    state: present
    force_init: true
    provider_upgrade: true
    # lock: true
    # targets:
    #   - portainer_stack.{{ compose_name }}
  delegate_to: localhost
  register: tf_output


- name: Display Terraform output for Docker LXC
  ansible.builtin.debug:
    msg: "{{ tf_output }}"
  delegate_to: localhost  # Added this to run locally


# TODO: MAKE SURE THAT THE /dockers EXISTS IN THE HOME OF REMOTE